<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Qu·∫£n l√Ω Ecommerce</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="./index.css">
  <style>
    /* B·∫°n c√≥ th·ªÉ th√™m CSS ·ªü ƒë√¢y n·∫øu c·∫ßn */
  </style>
</head>

<body>
  <div class="layout_all">
    <!-- MENU -->
    <div class="menu_left">
      <h2 class="logo_text"><i class="fa-solid fa-fire" style="color:red"></i> Ecommerce</h2>
      <ul class="menu_list">
        <li class="menu_item active" data-target="stats">Th·ªëng k√™</li>
        <li class="menu_item" data-target="cats">Danh m·ª•c</li>
        <li class="menu_item" data-target="prods">S·∫£n ph·∫©m</li>
      </ul>
    </div>

    <!-- N·ªòI DUNG -->
    <div class="content_main">
      <!-- Th·ªëng k√™ -->
      <div id="stats" class="tab-content">
        <h2 style="font-size: 36px;">Trang Th·ªëng k√™</h2>
        <div style="display: flex; justify-content: center;">
          <div>
            <p style="margin-top: 80px;" id="totalCategories">T·ªïng danh m·ª•c: 0</p>
            <img src="https://png.pngtree.com/png-vector/20220701/ourmid/pngtree-check-list-mark-icon-checklist-png-image_5452093.png" alt="">
          </div>
          <div>
            <p id="totalProducts">T·ªïng s·∫£n ph·∫©m: 0</p>
            <img src="https://cdn.vietnambiz.vn/2019/8/15/product-review-writing-services-15658537611611796432875.jpg" alt="">
          </div>
        </div>
      </div>

      <!-- Danh m·ª•c -->
      <div id="cats" class="tab-content" style="display:none">
        <div class="header_main">
          <h2>Danh m·ª•c</h2>
          <button class="btn_add" onclick="openCategoryForm()">Th√™m danh m·ª•c</button>
        </div>
        <div style="display: flex; flex-direction: row-reverse;">
          <div class="filter_search">
            <select class="select_filter" onchange="filterCategoryList()">
              <option value="all">T·∫•t c·∫£</option>
              <option value="active">ƒêang ho·∫°t ƒë·ªông</option>
              <option value="inactive">Ng∆∞ng ho·∫°t ƒë·ªông</option>
            </select>
            <select class="select_cat" onchange="filterCategoryList()">
              <option value="">T·∫•t c·∫£</option>
              <option value="Qu·∫ßn √°o">Qu·∫ßn √°o</option>
              <option value="Gi√†y d√©p">Gi√†y d√©p</option>
              <option value="Ph·ª• ki·ªán">Ph·ª• ki·ªán</option>
            </select>
            <input type="text" class="input_search" placeholder="T√¨m ki·∫øm t√™n" oninput="filterCategoryList()">
            <button style="width:35px;" class="btn_filter"><i class="fa-solid fa-magnifying-glass"></i></button>
          </div>
        </div>
        <!-- Modal th√™m/s·ª≠a danh m·ª•c -->
<div id="categoryModal" class="modal" style="display: none;">
  <div class="modal_content1">
    <h3  id="categoryModalTitle">Th√™m danh m·ª•c</h3>
    <form>
      <label id="label">M√£ danh muc</label>
      <input type="text" placeholder="m√£ danh muc">
      <input type="hidden" id="categoryIdInput">
      
      <div class="form-group">
        <label id="label" for="categoryNameInput">T√™n danh m·ª•c</label>
        <input type="text" id="categoryNameInput" placeholder="T√™n danh m·ª•c" required>
      </div>

      <div class="form-group">
        <label id="label">Tr·∫°ng th√°i</label>
        <div style="margin-top: 20px;">
          <label><input type="radio" name="status" value="active" checked> ƒêang ho·∫°t ƒë·ªông</label>
          <label><input type="radio" name="status" value="inactive"> Ng∆∞ng ho·∫°t ƒë·ªông</label>
        </div>
      </div>

      <div class="modal_buttons">
        
        <button type="button" class="btn_cancel" onclick="closeModal('categoryModal')">H·ªßy</button>
        <button type="button" class="btn_save" onclick="saveCategory()">Th√™m</button>

      </div>
    </form>
  </div>
</div>
        <table class="table_data">
          <thead>
            <tr>
              <th>M√£ danh m·ª•c <i class="fa-solid fa-arrow-down"></i></th>
              <th>T√™n danh m·ª•c <i class="fa-solid fa-arrow-down"></i></th>
              <th>Tr·∫°ng th√°i</th>
              <th>Ch·ª©c nƒÉng</th>
            </tr>
          </thead>
          <tbody id="categoriesTableBody"></tbody>
        </table>
        <div id="categoriesPagination" class="pagination"></div>
      </div>

      <!-- S·∫£n ph·∫©m -->
      <div id="prods" class="tab-content" style="display:none">
        <div class="header_main">
          <h2>S·∫£n ph·∫©m</h2>
          <button class="btn_add" onclick="openProductForm()">Th√™m s·∫£n ph·∫©m</button>
        </div>
        <table class="table_data">
          <thead>
            <tr>
              <th>M√£ s·∫£n ph·∫©m</th>
              <th>T√™n s·∫£n ph·∫©m</th>
              <th>Danh m·ª•c</th>
              <th>Gi√°</th>
              <th>S·ªë l∆∞·ª£ng</th>
              <th>Gi·∫£m gi√°</th>
              <th>Tr·∫°ng th√°i</th>
              <th>H√¨nh ·∫£nh</th>
              <th>Ch·ª©c nƒÉng</th>
            </tr>
          </thead>
          <tbody id="productsTableBody"></tbody>
        </table>
      </div>
    </div>
  </div>

<!-- Modal th√™m/s·ª≠a s·∫£n ph·∫©m -->
<div id="productModal" class="modal" style="display:none;">
  <div class="modal_content">
    <h3 id="productModalTitle">Th√™m s·∫£n ph·∫©m</h3>
    <form>

      <!-- M√£ s·∫£n ph·∫©m v√† T√™n s·∫£n ph·∫©m -->
      <div class="form-group">
        <div>
          <label id="label"  for="productIdInput">M√£ s·∫£n ph·∫©m</label>
          <input type="text" id="productIdInput">
        </div>
        <div>
          <label id="label" for="productNameInput">T√™n s·∫£n ph·∫©m</label>
          <input type="text" id="productNameInput" placeholder="T√™n s·∫£n ph·∫©m" required>
        </div>
      </div>

      <!-- Danh m·ª•c -->
      <div class="form-group">
        <label id="label" for="categorySelect">Danh m·ª•c</label>
        <select id="categorySelect" required>
          <option value="">Ch·ªçn danh m·ª•c</option>
          <option value="Qu·∫ßn √°o">Qu·∫ßn √°o</option>
          <option value="Gi√†y d√©p">Gi√†y d√©p</option>
          <option value="Ph·ª• ki·ªán">Ph·ª• ki·ªán</option>
        </select>
       <!-- Tr·∫°ng th√°i -->
 <div class="status-group">
  <label id="label">Tr·∫°ng th√°i</label>
  <div>
    <label><input type="radio" name="status" value="active" checked> ƒêang ho·∫°t ƒë·ªông</label>
    <label><input type="radio" name="status" value="inactive"> Ng∆∞ng ho·∫°t ƒë·ªông</label>
  </div>
</div>
      </div>


      
      <!-- Gi√°, S·ªë l∆∞·ª£ng, Gi·∫£m gi√° -->
      <div id="pire" class="form-group">
        <div>
          <label id="label" for="productPriceInput">Gi√° s·∫£n ph·∫©m</label>
          <input type="number" id="productPriceInput" placeholder="Gi√° s·∫£n ph·∫©m" required>
        </div>
        <div>
          <label id="label" for="quantityInput">S·ªë l∆∞·ª£ng</label>
          <input type="number" id="quantityInput" placeholder="S·ªë l∆∞·ª£ng" value="1" required>
        </div>
        <div>
          <label id="label" for="discountInput">Gi·∫£m gi√°</label>
          <input type="number" id="discountInput" placeholder="Gi·∫£m gi√°" value="0">
        </div>
      </div>

      <!-- Link h√¨nh ·∫£nh -->
      <div class="full-width">
        <label id="label" for="imageInput">Link h√¨nh ·∫£nh</label>
        <input type="text" id="imageInput" placeholder="Link h√¨nh ·∫£nh" required>
      </div>

      <!-- M√¥ t·∫£ s·∫£n ph·∫©m -->
      <div class="full-width">
        <label id="label" for="descriptionInput">M√¥ t·∫£ s·∫£n ph·∫©m</label>
        <textarea id="descriptionInput" placeholder="M√¥ t·∫£ s·∫£n ph·∫©m" rows="4"></textarea>
      </div>

      
      <!-- Buttons -->
      <div class="modal_buttons">
        
        <button type="button" class="btn_cancel" onclick="closeModal('productModal')">H·ªßy</button>
        <button type="button" class="btn_save" onclick="saveProduct()">Th√™m</button>

      </div>

    </form>
  </div>
</div>


    <!-- Buttons -->
    <div class="modal_buttons">
      <button class="btn_cancel" onclick="closeModal('productModal')">H·ªßy</button>
      <button class="btn_save" onclick="saveProduct()">Th√™m</button>
    </div>
  </div>
</div>


  <!-- JavaScript -->
  <script>
    const appData = { categories: [], products: [] };
    function loadAppData() {
      const raw = localStorage.getItem('ecomData');
      if (raw) Object.assign(appData, JSON.parse(raw));
    }
    function saveAppData() {
      localStorage.setItem('ecomData', JSON.stringify(appData));
    }

    let filteredCategories = [];
    let currentCategoryPage = 1;
    const categoriesPerPage = 3;

    const totalCategoriesEl = document.getElementById('totalCategories');
    const totalProductsEl = document.getElementById('totalProducts');
    const categoriesBody = document.getElementById('categoriesTableBody');
    const productsBody = document.getElementById('productsTableBody');
    const paginationEl = document.getElementById('categoriesPagination');
    const statusFilterEl = document.querySelector('.select_filter');
    const categoryFilterEl = document.querySelector('.select_cat');
    const searchInputEl = document.querySelector('.input_search');

    function renderStatistics() {
      totalCategoriesEl.textContent = 'T·ªïng danh m·ª•c: ' + appData.categories.length;
      totalProductsEl.textContent = 'T·ªïng s·∫£n ph·∫©m: ' + appData.products.length;
    }

    function renderCategoryTable() {
      categoriesBody.innerHTML = '';
      const totalItems = filteredCategories.length;
      const totalPages = Math.ceil(totalItems / categoriesPerPage) || 1;
      if (currentCategoryPage > totalPages) currentCategoryPage = totalPages;
      const start = (currentCategoryPage - 1) * categoriesPerPage;
      const pageItems = filteredCategories.slice(start, start + categoriesPerPage);
      pageItems.forEach(c => {
        categoriesBody.insertAdjacentHTML('beforeend', `
          <tr>
              <td>${c.id}</td>
            <td>${c.name}</td>
            <td>
              <span class="status-badge ${c.status === 'active' ? 'status-active' : 'status-inactive'}">
                <span class="dot"></span>
                ${c.status === 'active' ? 'ƒêang ho·∫°t ƒë·ªông' : 'Ng∆∞ng ho·∫°t ƒë·ªông'}
              </span>
            </td>
            <td>
              <span onclick="editCategoryById('${c.id}')"><button>‚úèÔ∏è</button></span>
              <span onclick="deleteCategoryById('${c.id}')"><button>üóëÔ∏è</button></span>
            </td>
          </tr>`);
      });
      renderPagination(totalPages);
    }

    function renderPagination(totalPages) {
      paginationEl.innerHTML = '';
      if (totalPages <= 1) return;
      if (currentCategoryPage > 1) paginationEl.insertAdjacentHTML('beforeend', `<button onclick="changeCategoryPage(${currentCategoryPage - 1})">¬´ Prev</button>`);
      for (let i = 1; i <= totalPages; i++) {
        paginationEl.insertAdjacentHTML('beforeend', `<button class="${i === currentCategoryPage ? 'active' : ''}" onclick="changeCategoryPage(${i})">${i}</button>`);
      }
      if (currentCategoryPage < totalPages) paginationEl.insertAdjacentHTML('beforeend', `<button onclick="changeCategoryPage(${currentCategoryPage + 1})">Next ¬ª</button>`);
    }

    function changeCategoryPage(p) { currentCategoryPage = p; renderCategoryTable(); }

    function renderProductTable() {
      productsBody.innerHTML = '';
      appData.products.forEach(p => {
        productsBody.insertAdjacentHTML('beforeend', `
          <tr>
            <td>${p.id}</td>
            <td>${p.name}</td>
            <td>${p.category}</td>
            <td>${p.price.toLocaleString()}‚Ç´</td>
            <td>${p.quantity}</td>
            <td>${p.discount}%</td>
            <td>
              <span class="status-badge ${p.status === 'active' ? 'status-active' : 'status-inactive'}">
                ${p.status === 'active' ? 'ƒêang ho·∫°t ƒë·ªông' : 'Ng∆∞ng ho·∫°t ƒë·ªông'}
              </span>
            </td>
            <td><img src="${p.image}" alt="${p.name}" style="width:50px;height:50px;object-fit:cover;border-radius:5px;"></td>
            <td>
              <button onclick="editProductById('${p.id}')">‚úèÔ∏è</button>
              <button onclick="deleteProductById('${p.id}')">üóëÔ∏è</button>
            </td>
          </tr>`);
      });
    }

    function applyFilters() {
      const status = statusFilterEl.value;
      const catVal = categoryFilterEl.value.toLowerCase();
      const kw = searchInputEl.value.toLowerCase();
      filteredCategories = appData.categories.filter(c =>
        (status === 'all' || c.status === status) &&
        (!catVal || c.name.toLowerCase() === catVal) &&
        (!kw || c.name.toLowerCase().includes(kw))
      );
      currentCategoryPage = 1;
      renderCategoryTable();
    }

    function filterCategoryList() { applyFilters(); }

    document.addEventListener('DOMContentLoaded', () => {
      loadAppData();
      filteredCategories = [...appData.categories];
      applyFilters();
      renderProductTable();
      document.querySelectorAll('.menu_item').forEach(tab => {
        tab.onclick = () => {
          document.querySelectorAll('.menu_item').forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
          document.getElementById(tab.dataset.target).style.display = 'block';
          if (tab.dataset.target === 'stats') renderStatistics();
        };
      });
    });

    function openCategoryForm() {
  document.getElementById('categoryIdInput').value = '';
  document.getElementById('categoryNameInput').value = '';
  document.getElementById('categoryModalTitle').textContent = 'Th√™m danh m·ª•c';
  document.getElementById('categoryModal').style.display = 'flex';
}

function editCategoryById(id) {
  const cat = appData.categories.find(c => c.id === id);
  if (!cat) return alert('Kh√¥ng t√¨m th·∫•y danh m·ª•c!');
  document.getElementById('categoryIdInput').value = cat.id;
  document.getElementById('categoryNameInput').value = cat.name;
  document.getElementById('categoryModalTitle').textContent = 'S·ª≠a danh m·ª•c';
  document.getElementById('categoryModal').style.display = 'flex';
}

function saveCategory() {
  const id = document.getElementById('categoryIdInput').value; // L·∫•y ID
  const name = document.getElementById('categoryNameInput').value.trim(); // L·∫•y t√™n v√† lo·∫°i b·ªè kho·∫£ng tr·∫Øng
  const status = document.querySelector('input[name="status"]:checked').value; // L·∫•y tr·∫°ng th√°i

  if (!name) return alert('Nh·∫≠p t√™n danh m·ª•c'); // Ki·ªÉm tra t√™n c√≥ h·ª£p l·ªá kh√¥ng

  if (id) {
    // N·∫øu c√≥ ID, c·∫≠p nh·∫≠t danh m·ª•c
    const cat = appData.categories.find(c => c.id === id);
    if (cat) {
      cat.name = name;
      cat.status = status; // C·∫≠p nh·∫≠t tr·∫°ng th√°i
    }
  } else {
    // N·∫øu kh√¥ng c√≥ ID, th√™m danh m·ª•c m·ªõi
    const newId = 'DM' + String(appData.categories.length + 1).padStart(3, '0'); // T·∫°o ID m·ªõi
    appData.categories.push({ id: newId, name, status }); // Th√™m danh m·ª•c m·ªõi v√†o danh s√°ch
  }

  saveAppData(); // L∆∞u d·ªØ li·ªáu v√†o localStorage
  closeModal('categoryModal'); // ƒê√≥ng modal
  applyFilters(); // C·∫≠p nh·∫≠t b·∫£ng danh m·ª•c
}
function deleteCategoryById(id) {
  if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a danh m·ª•c n√†y?')) {
    appData.categories = appData.categories.filter(c => c.id !== id);
    saveAppData();
    applyFilters(); // C·∫≠p nh·∫≠t b·∫£ng danh m·ª•c
  }
}


function closeModal(modalId) {
  document.getElementById(modalId).style.display = 'none';
}
    function openProductForm() {
      document.getElementById('productIdInput').value = '';
      document.getElementById('productNameInput').value = '';
      document.getElementById('categorySelect').value = '';
      document.querySelector('input[name="status"][value="active"]').checked = true;
      document.getElementById('quantityInput').value = '1';
      document.getElementById('productPriceInput').value = '';
      document.getElementById('discountInput').value = '0';
      document.getElementById('imageInput').value = '';
      document.getElementById('descriptionInput').value = '';
      document.getElementById('productModalTitle').textContent = 'Th√™m s·∫£n ph·∫©m';
      document.getElementById('productModal').style.display = 'flex';
    }

    function editProductById(id) {
  const product = appData.products.find(p => p.id === id);
  if (!product) return alert('Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m!');

  const modal = document.getElementById('productModal');

  // ƒêi·ªÅn th√¥ng tin s·∫£n ph·∫©m v√†o c√°c tr∆∞·ªùng trong modal
  modal.querySelector('#productIdInput').value       = product.id;
  modal.querySelector('#productNameInput').value     = product.name;
  modal.querySelector('#categorySelect').value       = product.category;
  modal.querySelector(`input[name="status"][value="${product.status}"]`).checked = true;
  modal.querySelector('#quantityInput').value        = product.quantity;
  modal.querySelector('#productPriceInput').value    = product.price;
  modal.querySelector('#discountInput').value        = product.discount;
  modal.querySelector('#imageInput').value           = product.image;
  modal.querySelector('#descriptionInput').value     = product.description;

  // Thay ƒë·ªïi ti√™u ƒë·ªÅ modal
  modal.querySelector('#productModalTitle').textContent = 'S·ª≠a s·∫£n ph·∫©m';
  
  // Hi·ªÉn th·ªã modal
  modal.style.display = 'flex';
}

function saveProduct() {
  const modal = document.getElementById('productModal');

  const id          = modal.querySelector('#productIdInput').value;
  const name        = modal.querySelector('#productNameInput').value.trim();
  const category    = modal.querySelector('#categorySelect').value;
  const status      = modal.querySelector('input[name="status"]:checked').value;
  const quantity    = parseInt(modal.querySelector('#quantityInput').value, 10) || 0;
  const price       = parseInt(modal.querySelector('#productPriceInput').value, 10) || 0;
  const discount    = parseInt(modal.querySelector('#discountInput').value, 10) || 0;
  const image       = modal.querySelector('#imageInput').value.trim();
  const description = modal.querySelector('#descriptionInput').value.trim();

  if (!name || !price || !image) {
    alert('Vui l√≤ng nh·∫≠p ƒë·ªß T√™n, Gi√° v√† ·∫¢nh s·∫£n ph·∫©m!');
    return;
  }

  if (id) {
    // S·ª≠a s·∫£n ph·∫©m
    const p = appData.products.find(x => x.id === id);
    if (p) {
      Object.assign(p, { name, category, status, quantity, price, discount, image, description });
    }
  } else {
    // Th√™m m·ªõi
    const newId = 'SP' + String(appData.products.length + 1).padStart(3, '0');
    appData.products.push({ id: newId, name, category, status, quantity, price, discount, image, description });
  }

  saveAppData();
  modal.style.display = 'none';
  renderProductTable();
  renderStatistics();
}
  </script>
</body>
</html>